<!-- dat-ve-rap-phim.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Đặt Vé Rạp Phim</title>
    <link rel="stylesheet" th:href="@{/css/main.css }">
    <script>
        function showStep(step) {
            document.querySelectorAll('.step').forEach(s => s.style.display = 'none');
            document.getElementById(step).style.display = 'block';
        }

        function selectSuatChieu(suatChieuId) {
            document.getElementById('suatChieuId').value = suatChieuId;
            showStep('step2');
        }

        function selectGhe(gheId) {
            document.getElementById('gheId').value = gheId;
            showStep('step3');
        }
    </script>
</head>
<body>
<h2>Đặt Vé Xem Phim</h2>

<!-- Bước 1: Chọn suất chiếu -->
<div id="step1" class="step">
    <h3>Chọn Suất Chiếu</h3>
    <table border="1">
        <tr>
            <th>Phim</th>
            <th>Phòng Chiếu</th>
            <th>Ngày Chiếu</th>
            <th>Giờ Bắt Đầu</th>
            <th>Giá Vé</th>
            <th>Chọn</th>
        </tr>
        <tr th:each="suat : ${suats}">
            <td th:text="${suat.phim?.tenPhim}"></td>
            <td th:text="${suat.phongChieu?.tenPhong}"></td>
            <td th:text="${suat.ngayChieu}"></td>
            <td th:text="${suat.gioBatDau}"></td>
            <td th:text="${suat.giaVe} + ' VND'"></td>
            <td>
                <button type="button" th:onclick="'selectSuatChieu(' + ${suat.id} + ')'">Chọn</button>
            </td>
        </tr>
    </table>
</div>

<!-- Bước 2: Chọn ghế -->
<div id="step2" class="step" style="display:none;">
    <h3>Chọn Ghế</h3>
    <form action="/cinemas/ve/save" method="post">
        <input type="hidden" id="suatChieuId" name="suatChieuId">
        <input type="hidden" id="gheId" name="gheId">

        <div class="seat-map">
            <button type="button" th:each="ghe : ${ghes}"
                    th:text="${ghe.soGhe}"
                    th:classappend="${ghe.trangThaiGhe == 'Đã đặt' ? 'ghe-da-dat' : 'ghe-trong'}"
                    th:disabled="${ghe.trangThaiGhe == 'Đã đặt'}"
                    th:onclick="'selectGhe(' + ${ghe.id} + ')'"
                    th:value="${ghe.id}">
            </button>
        </div>
    </form>
</div>

<!-- Bước 3: Xác nhận vé -->
<div id="step3" class="step" style="display:none;">
    <h3>Thông Tin Vé</h3>
    <p><strong>Id:</strong> <span th:text="${ve?.id}"></span></p>
    <p><strong>Phim:</strong> <span th:text="${ve?.suatChieu?.phim?.tenPhim}"></span></p>
    <p><strong>Phòng Chiếu:</strong> <span th:text="${ve?.suatChieu?.phongChieu?.tenPhong}"></span></p>
    <p><strong>Ngày Chiếu:</strong> <span th:text="${ve?.suatChieu?.ngayChieu}"></span></p>
    <p><strong>Giờ Bắt Đầu:</strong> <span th:text="${ve?.suatChieu?.gioBatDau}"></span></p>
    <p><strong>Ghế:</strong> <span th:text="${ve?.ghe?.soGhe}"></span></p>
    <p><strong>Giá Vé:</strong> <span th:text="${ve?.suatChieu?.giaVe} + ' VND'"></span></p>
    <a href="/cinemas/">Quay lại Trang Chủ</a>
</div>

</body>
</html>
